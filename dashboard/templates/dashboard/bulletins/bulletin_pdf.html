<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Bulletin de {{ etudiant.prenom }} {{ etudiant.nom }}</title>
    <style>
        body { font-family: 'DejaVu Sans', sans-serif; margin: 0; padding: 0; }
        .container { width: 90%; margin: auto; padding: 20px; border: 2px solid #000; }
        .header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 10px; }
        .header img { height: 70px; }
        h2 { text-align: center; margin: 10px 0; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { border: 1px solid #000; padding: 6px; text-align: center; }
        th { background: #003366; color: white; }
        .footer { margin-top: 30px; display: flex; justify-content: space-between; }
        .footer div { width: 45%; text-align: center; }
        .info-eleve { margin-top: 15px; }
        .info-eleve p { margin: 4px 0; }
        .moyenne { margin-top: 10px; font-weight: bold; }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        {% if ecole.logo %}
            <img src="{{ ecole.logo.url }}" alt="Logo École">
        {% endif %}
        <h3>RÉPUBLIQUE DU MALI</h3>
        <p>Un Peuple – Un But – Une Foi</p>
        <h4>{{ ecole.nom_etablissement }}</h4>
        <p>{{ ecole.adresse_etablissement }}</p>
    </div>

    <h2>BULLETIN SCOLAIRE - {{ periode }}</h2>

    <div class="info-eleve">
        <p><strong>Nom et prénom :</strong> {{ etudiant.nom }} {{ etudiant.prenom }}</p>
        <p><strong>Classe :</strong> {{ etudiant.classe.nom_classe }}</p>
        <p><strong>Année scolaire :</strong> {{ annee_scolaire.annee }}</p>
    </div>

    <table>
        <thead>
            <tr>
                <th>Matière</th>
                <th>Note /20</th>
                <th>Coefficient</th>
                <th>Points</th>
                <th>Appréciation</th>
            </tr>
        </thead>
        <tbody>
            {% for ligne in lignes_bulletin %}
            <tr>
                <td>{{ ligne.matiere }}</td>
                <td>{{ ligne.note }}</td>
                <td>{{ ligne.coef }}</td>
                <td>{{ ligne.points }}</td>
                <td>
                    {% if ligne.note >= 16 %} Excellent
                    {% elif ligne.note >= 14 %} Très Bien
                    {% elif ligne.note >= 12 %} Bien
                    {% elif ligne.note >= 10 %} Passable
                    {% else %} Insuffisant {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <p class="moyenne">Moyenne générale : {{ moyenne }}/20</p>

    <div class="footer">
        <div>
            <p><strong>Appréciation du conseil :</strong></p>
            <p>
                {% if moyenne >= 16 %} Félicitations du conseil.
                {% elif moyenne >= 14 %} Encouragements.
                {% elif moyenne >= 12 %} Travail satisfaisant.
                {% elif moyenne >= 10 %} Peut mieux faire.
                {% else %} Doit redoubler d’efforts. {% endif %}
            </p>
        </div>
        <div>
            <p><strong>Le Chef d’Établissement</strong></p>
            {% if ecole.signature_directeur %}
                <img src="{{ ecole.signature_directeur.url }}" height="70" alt="Signature">
            {% endif %}
        </div>
    </div>
</div>
</body>
</html>
